import"../chunks/DsnmJJEf.js";import{i as Ge}from"../chunks/C0BKmxfe.js";import{o as ze,e as ae,s as ne}from"../chunks/BuNEtrVY.js";import{c as ve,h as V,O as je,e as Pe,a as Ke,b as Je,C as a,P as Ve,r as We,H as Ye,s as Oe,d as ce,k as re,Q as Be,R as Ue,f as we,i as Xe,g as Ze,S as De,T as Ne,V as j,W as Se,X as Ie,j as Re,p as Qe,Y as oe,Z as _e,_ as Le,$ as le,a0 as ea,a1 as aa,a2 as ra,a3 as ta,a4 as ia,a5 as na,a6 as He,a7 as sa,a8 as oa,a9 as la,aa as da,ab as fa,ac as ua,ad as va,I as ca,ae as se,af as _a,t as B,M as G,n as pe,q,J as pa,ag as T,z,K as P,L as M,u as ee,ah as ma,ai as ha,l as Ce,aj as ga,ak as wa,al as Me}from"../chunks/BkHzRi2O.js";import{i as te}from"../chunks/CbxNRxmd.js";import{a as ya}from"../chunks/BOGb0i0E.js";function me(r,s){return s}function ba(r,s,e){for(var n=r.items,l=[],i=s.length,o=0;o<i;o++)ra(s[o].e,l,!0);var v=i>0&&l.length===0&&e!==null;if(v){var m=e.parentNode;ta(m),m.append(e),n.clear(),K(r,s[0].prev,s[i-1].next)}ia(l,()=>{for(var y=0;y<i;y++){var h=s[y];v||(n.delete(h.k),K(r,h.prev,h.next)),Le(h.e,!v)}})}function he(r,s,e,n,l,i=null){var o=r,v={flags:s,items:new Map,first:null},m=(s&He)!==0;if(m){var y=r;o=V?ve(je(y)):y.appendChild(Pe())}V&&Ke();var h=null,O=!1,x=new Map,D=Ve(()=>{var b=e();return Ne(b)?b:b==null?[]:De(b)}),u,g;function p(){ka(g,u,v,x,o,l,s,n,e),i!==null&&(u.length===0?h?Re(h):h=we(()=>i(o)):h!==null&&Qe(h,()=>{h=null}))}Je(()=>{g??=na,u=a(D);var b=u.length;if(O&&b===0)return;O=b===0;let S=!1;if(V){var N=We(o)===Ye;N!==(b===0)&&(o=Oe(),ve(o),ce(!1),S=!0)}if(V){for(var L=null,A,d=0;d<b;d++){if(re.nodeType===Be&&re.data===Ue){o=re,S=!0,ce(!1);break}var c=u[d],t=n(c,d);A=ye(re,v,L,null,c,t,d,l,s,e),v.items.set(t,A),L=A}b>0&&ve(Oe())}if(V)b===0&&i&&(h=we(()=>i(o)));else if(Xe()){var f=new Set,_=Ze;for(d=0;d<b;d+=1){c=u[d],t=n(c,d);var w=v.items.get(t)??x.get(t);w?(s&(le|oe))!==0&&$e(w,c,d,s):(A=ye(null,v,null,null,c,t,d,l,s,e,!0),x.set(t,A)),f.add(t)}for(const[k,E]of v.items)f.has(k)||_.skipped_effects.add(E.e);_.add_callback(p)}else p();S&&ce(!0),a(D)}),V&&(o=re)}function ka(r,s,e,n,l,i,o,v,m){var y=(o&oa)!==0,h=(o&(le|oe))!==0,O=s.length,x=e.items,D=e.first,u=D,g,p=null,b,S=[],N=[],L,A,d,c;if(y)for(c=0;c<O;c+=1)L=s[c],A=v(L,c),d=x.get(A),d!==void 0&&(d.a?.measure(),(b??=new Set).add(d));for(c=0;c<O;c+=1){if(L=s[c],A=v(L,c),d=x.get(A),d===void 0){var t=n.get(A);if(t!==void 0){n.delete(A),x.set(A,t);var f=p?p.next:u;K(e,p,t),K(e,t,f),ge(t,f,l),p=t}else{var _=u?u.e.nodes_start:l;p=ye(_,e,p,p===null?e.first:p.next,L,A,c,i,o,m)}x.set(A,p),S=[],N=[],u=p.next;continue}if(h&&$e(d,L,c,o),(d.e.f&_e)!==0&&(Re(d.e),y&&(d.a?.unfix(),(b??=new Set).delete(d))),d!==u){if(g!==void 0&&g.has(d)){if(S.length<N.length){var w=N[0],k;p=w.prev;var E=S[0],F=S[S.length-1];for(k=0;k<S.length;k+=1)ge(S[k],w,l);for(k=0;k<N.length;k+=1)g.delete(N[k]);K(e,E.prev,F.next),K(e,p,E),K(e,F,w),u=w,p=F,c-=1,S=[],N=[]}else g.delete(d),ge(d,u,l),K(e,d.prev,d.next),K(e,d,p===null?e.first:p.next),K(e,p,d),p=d;continue}for(S=[],N=[];u!==null&&u.k!==A;)(u.e.f&_e)===0&&(g??=new Set).add(u),N.push(u),u=u.next;if(u===null)continue;d=u}S.push(d),p=d,u=d.next}if(u!==null||g!==void 0){for(var H=g===void 0?[]:De(g);u!==null;)(u.e.f&_e)===0&&H.push(u),u=u.next;var I=H.length;if(I>0){var $=(o&He)!==0&&O===0?l:null;if(y){for(c=0;c<I;c+=1)H[c].a?.measure();for(c=0;c<I;c+=1)H[c].a?.fix()}ba(e,H,$)}}y&&sa(()=>{if(b!==void 0)for(d of b)d.a?.apply()}),r.first=e.first&&e.first.e,r.last=p&&p.e;for(var X of n.values())Le(X.e);n.clear()}function $e(r,s,e,n){(n&le)!==0&&Ie(r.v,s),(n&oe)!==0?Ie(r.i,e):r.i=e}function ye(r,s,e,n,l,i,o,v,m,y,h){var O=(m&le)!==0,x=(m&ea)===0,D=O?x?j(l,!1,!1):Se(l):l,u=(m&oe)===0?o:Se(o),g={i:u,v:D,k:i,a:null,e:null,prev:e,next:n};try{if(r===null){var p=document.createDocumentFragment();p.append(r=Pe())}return g.e=we(()=>v(r,D,u,y),V),g.e.prev=e&&e.e,g.e.next=n&&n.e,e===null?h||(s.first=g):(e.next=g,e.e.next=g.e),n!==null&&(n.prev=g,n.e.prev=g.e),g}finally{}}function ge(r,s,e){for(var n=r.next?r.next.e.nodes_start:e,l=s?s.e.nodes_start:e,i=r.e.nodes_start;i!==null&&i!==n;){var o=aa(i);l.before(i),i=o}}function K(r,s,e){s===null?r.first=e:(s.next=e,s.e.next=e&&e.e),e!==null&&(e.prev=s,e.e.prev=s&&s.e)}const xe=[...` 	
\r\fÂ \v\uFEFF`];function Ea(r,s,e){var n=""+r;if(e){for(var l in e)if(e[l])n=n?n+" "+l:l;else if(n.length)for(var i=l.length,o=0;(o=n.indexOf(l,o))>=0;){var v=o+i;(o===0||xe.includes(n[o-1]))&&(v===n.length||xe.includes(n[v]))?n=(o===0?"":n.substring(0,o))+n.substring(v+1):o=v}}return n===""?null:n}function Aa(r,s,e,n,l,i){var o=r.__className;if(V||o!==e||o===void 0){var v=Ea(e,n,i);(!V||v!==r.getAttribute("class"))&&(v==null?r.removeAttribute("class"):r.className=v),r.__className=e}else if(i&&l!==i)for(var m in i){var y=!!i[m];(l==null||y!==!!l[m])&&r.classList.toggle(m,y)}return i}function qe(r,s,e=!1){if(r.multiple){if(s==null)return;if(!Ne(s))return fa();for(var n of r.options)n.selected=s.includes(ie(n));return}for(n of r.options){var l=ie(n);if(ua(l,s)){n.selected=!0;return}}(!e||s!==void 0)&&(r.selectedIndex=-1)}function Ta(r){var s=new MutationObserver(()=>{qe(r,r.__value)});s.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),va(()=>{s.disconnect()})}function Oa(r,s,e=s){var n=!0;la(r,"change",l=>{var i=l?"[selected]":":checked",o;if(r.multiple)o=[].map.call(r.querySelectorAll(i),ie);else{var v=r.querySelector(i)??r.querySelector("option:not([disabled])");o=v&&ie(v)}e(o)}),da(()=>{var l=s();if(qe(r,l,n),n&&l===void 0){var i=r.querySelector(":checked");i!==null&&(l=ie(i),e(l))}r.__value=l,n=!1}),Ta(r)}function ie(r){return"__value"in r?r.__value:r.value}var Sa=B('<div class="participant-item"><div class="participant-info"><div class="participant-name"> </div></div></div>'),Ia=B('<div class="theme-group"><h3> </h3> <!></div>'),Ca=B("<p>No order generated yet.</p>"),Ma=B('<div class="results"><h2>Presentation Order</h2> <!> <!> <div class="results-actions"><button class="clear-button">Clear All Data</button></div></div>'),xa=B("<option> </option>"),Pa=B("<p>Generating...</p>"),Da=B('<div class="input-section"><h2>Enter information</h2> <p>All 15 participants must fill out their information before generating the order</p> <div class="participant-list"><div class="select-container"><select class="name-input"></select></div> <div class="keywords-container"><textarea class="keywords-input" placeholder="Keywords (comma separated)" rows="6"></textarea></div></div> <button>Save</button> <div class="action-section"><button><!></button></div> <button class="clear-button">Clear All Data</button></div>'),Na=B('<div class="container"></div> <h1>Presentation randomizer</h1> <!>',1);function Ga(r,s){ca(s,!1);const e=j(),n=j(),l=j();let i=j([{name:"Arnar",id:0,keywords:""},{name:"Cassandra",id:1,keywords:""},{name:"Costanza",id:2,keywords:""},{name:"Diana",id:3,keywords:""},{name:"Haotong",id:4,keywords:""},{name:"Kosara",id:5,keywords:""},{name:"Li",id:6,keywords:""},{name:"Luca M",id:7,keywords:""},{name:"Luca W",id:8,keywords:""},{name:"Lucas G",id:9,keywords:""},{name:"Martina",id:10,keywords:""},{name:"Matteo",id:11,keywords:""},{name:"Samuel",id:12,keywords:""},{name:"Sergio",id:13,keywords:""},{name:"Zhiyi",id:14,keywords:""}]),o=j(!1),v=j(!1),m=j([]),y=[],h=j(!1),O=j(0),x=!1;const D="https://randominfo.vercel.app";ze(async()=>{await u()});async function u(){try{const t=await fetch(`${D}/api/data`);if(t.ok){const f=await t.json();T(i,f.participants||a(i)),T(O,f.selectedParticipantId??0),T(h,f.isRandomized||!1),T(m,f.presentationOrder||[]),y=f.groups||[]}}catch(t){console.error("Error loading data:",t)}}async function g(){if(!x){x=!0;try{(await fetch(`${D}/api/data`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({participants:a(i),selectedParticipantId:a(O),isRandomized:a(h),presentationOrder:a(m),groups:y})})).ok||console.error("Failed to save data")}catch(t){console.error("Error saving data:",t)}finally{x=!1}}}function p(t){const f=a(i).map(_=>_.id===a(e).id?{..._,keywords:t.target.value}:_);T(i,f)}async function b(){try{(await fetch(`${D}/api/data`,{method:"DELETE"})).ok?(T(i,a(i).map(f=>({...f,keywords:""}))),T(h,!1),T(m,[]),y=[],T(O,0)):console.error("Failed to clear data")}catch(t){console.error("Error clearing data:",t)}}async function S(){if(!(!a(v)||a(h))){T(o,!0);try{console.log(`Calling API at ${D}`);const t=a(i).filter(E=>E.keywords.trim()!=="").map(E=>({name:E.name,keywords:E.keywords.trim()})),f=await fetch(`${D}/api/group-topics`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({participants:t})});if(!f.ok){const E=await f.json().catch(()=>({}));throw new Error(E.message||`HTTP ${f.status}: ${f.statusText}`)}const _=await f.json();if(!_.groups||!Array.isArray(_.groups))throw new Error("Invalid response format from server");console.log("Received data:",_);const w=N([..._.groups]),k=[];w.forEach(E=>{N([...E.members]).forEach(H=>{k.push({...H,theme:E.theme})})}),T(m,k),y=w,T(h,!0),await g()}catch(t){console.error("Error generating order:",t),`${t.message}`,t.message.includes("fetch")||t.message.includes("quota")||t.message.includes("API key")}finally{T(o,!1)}}}function N(t){const f=[...t];for(let _=f.length-1;_>0;_--){const w=Math.floor(Math.random()*(_+1));[f[_],f[w]]=[f[w],f[_]]}return f}se(()=>a(i),()=>{T(v,a(i).every(t=>t.keywords.trim()!==""))}),se(()=>(a(i),a(O)),()=>{T(e,a(i).find(t=>t.id===a(O))||a(i)[0])}),se(()=>a(i),()=>{T(n,a(i).filter(t=>t.keywords.trim()!=="").length)}),se(()=>a(m),()=>{T(l,a(m).reduce((t,f,_)=>{const w=f.theme;return t[w]||(t[w]=[]),t[w].push({...f,position:_+1}),t},{}))}),_a(),Ge();var L=Na(),A=G(pe(L),4);{var d=t=>{var f=Ma(),_=G(P(f),2);{var w=I=>{var $=Ce(),X=pe($);he(X,1,()=>(a(l),z(()=>Object.entries(a(l)))),me,(de,fe,be,ke)=>{var C=ga(()=>wa(a(fe),2));let R=()=>a(C)[0],J=()=>a(C)[1];var U=Ia(),W=P(U),Y=P(W,!0);M(W);var Z=G(W,2);he(Z,1,J,me,(Q,Ee)=>{var ue=Sa(),Ae=P(ue),Te=P(Ae),Fe=P(Te,!0);M(Te),M(Ae),M(ue),ee(()=>ne(Fe,(a(Ee),z(()=>a(Ee).name)))),q(Q,ue)}),M(U),ee(()=>ne(Y,R())),q(de,U)}),q(I,$)};te(_,I=>{a(l),z(()=>Object.keys(a(l)).length>0)&&I(w)})}var k=G(_,2);{var E=I=>{var $=Ca();q(I,$)};te(k,I=>{a(m),z(()=>a(m).length===0)&&I(E)})}var F=G(k,2),H=P(F);M(F),M(f),ae("click",H,b),q(t,f)},c=t=>{var f=Da(),_=G(P(f),4),w=P(_),k=P(w);ee(()=>{a(O),ma(()=>{a(i)})}),he(k,5,()=>a(i),me,(C,R)=>{var J=xa(),U=P(J,!0);M(J);var W={};ee(()=>{ne(U,(a(R),z(()=>a(R).name))),W!==(W=(a(R),z(()=>a(R).id)))&&(J.value=(J.__value=(a(R),z(()=>a(R).id)))??"")}),q(C,J)}),M(k),M(w);var E=G(w,2),F=P(E);ha(F),M(E),M(_);var H=G(_,2),I=G(H,2),$=P(I);let X;var de=P($);{var fe=C=>{var R=Pa();q(C,R)},be=C=>{var R=Ce(),J=pe(R);{var U=Y=>{var Z=Me();ee(Q=>ne(Z,`Waiting for all participants (${Q??""}/15)`),[()=>(a(i),z(()=>a(i).filter(Q=>Q.name.trim()&&Q.keywords.trim()).length))]),q(Y,Z)},W=Y=>{var Z=Me("Generate Presentation Order");q(Y,Z)};te(J,Y=>{a(v)?Y(W,!1):Y(U)},!0)}q(C,R)};te(de,C=>{a(o)?C(fe):C(be,!1)})}M($),M(I);var ke=G(I,2);M(f),ee(C=>{ya(F,(a(e),z(()=>a(e).keywords))),X=Aa($,1,"generate-button",null,X,C),$.disabled=!a(v)||a(o)},[()=>({disabled:!a(v)||a(o)})]),Oa(k,()=>a(O),C=>T(O,C)),ae("input",F,p),ae("click",H,()=>{g()}),ae("click",$,S),ae("click",ke,b),q(t,f)};te(A,t=>{a(h),a(m),z(()=>a(h)&&a(m).length>0)?t(d):t(c,!1)})}q(r,L),pa()}export{Ga as component};
