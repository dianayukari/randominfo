import"../chunks/DsnmJJEf.js";import{i as je}from"../chunks/C0BKmxfe.js";import{o as Ke,e as oe,s as le}from"../chunks/BuNEtrVY.js";import{c as pe,h as W,O as Je,e as Ne,a as Ve,b as We,C as a,P as Ye,r as Be,H as Ue,s as Se,d as _e,k as re,Q as Xe,R as Ze,f as be,i as Qe,g as ea,S as De,T as Le,V as H,W as Ie,X as Me,j as Re,p as aa,Y as de,Z as me,_ as He,$ as fe,a0 as ra,a1 as ta,a2 as ia,a3 as na,a4 as sa,a5 as oa,a6 as $e,a7 as la,a8 as da,a9 as fa,aa as ua,ab as va,ac as ca,ad as pa,I as _a,ae as te,af as ma,t as U,M as V,n as he,q as R,J as ha,ag as E,z as j,K as C,L as I,u as ee,ah as ga,ai as wa,l as xe,aj as ya,ak as ba,al as Ce}from"../chunks/BkHzRi2O.js";import{i as ie}from"../chunks/CbxNRxmd.js";import{a as ka}from"../chunks/BOGb0i0E.js";function ge(r,n){return n}function Ea(r,n,e){for(var i=r.items,o=[],t=n.length,s=0;s<t;s++)ia(n[s].e,o,!0);var c=t>0&&o.length===0&&e!==null;if(c){var m=e.parentNode;na(m),m.append(e),i.clear(),K(r,n[0].prev,n[t-1].next)}sa(o,()=>{for(var w=0;w<t;w++){var g=n[w];c||(i.delete(g.k),K(r,g.prev,g.next)),He(g.e,!c)}})}function we(r,n,e,i,o,t=null){var s=r,c={flags:n,items:new Map,first:null},m=(n&$e)!==0;if(m){var w=r;s=W?pe(Je(w)):w.appendChild(Ne())}W&&Ve();var g=null,T=!1,M=new Map,$=Ye(()=>{var y=e();return Le(y)?y:y==null?[]:De(y)}),u,h;function _(){Aa(h,u,c,M,s,o,n,i,e),t!==null&&(u.length===0?g?Re(g):g=be(()=>t(s)):g!==null&&aa(g,()=>{g=null}))}We(()=>{h??=oa,u=a($);var y=u.length;if(T&&y===0)return;T=y===0;let S=!1;if(W){var D=Be(s)===Ue;D!==(y===0)&&(s=Se(),pe(s),_e(!1),S=!0)}if(W){for(var q=null,A,d=0;d<y;d++){if(re.nodeType===Xe&&re.data===Ze){s=re,S=!0,_e(!1);break}var p=u[d],O=i(p,d);A=ke(re,c,q,null,p,O,d,o,n,e),c.items.set(O,A),q=A}y>0&&pe(Se())}if(W)y===0&&t&&(g=be(()=>t(s)));else if(Qe()){var X=new Set,l=ea;for(d=0;d<y;d+=1){p=u[d],O=i(p,d);var f=c.items.get(O)??M.get(O);f?(n&(fe|de))!==0&&qe(f,p,d,n):(A=ke(null,c,null,null,p,O,d,o,n,e,!0),M.set(O,A)),X.add(O)}for(const[v,b]of c.items)X.has(v)||l.skipped_effects.add(b.e);l.add_callback(_)}else _();S&&_e(!0),a($)}),W&&(s=re)}function Aa(r,n,e,i,o,t,s,c,m){var w=(s&da)!==0,g=(s&(fe|de))!==0,T=n.length,M=e.items,$=e.first,u=$,h,_=null,y,S=[],D=[],q,A,d,p;if(w)for(p=0;p<T;p+=1)q=n[p],A=c(q,p),d=M.get(A),d!==void 0&&(d.a?.measure(),(y??=new Set).add(d));for(p=0;p<T;p+=1){if(q=n[p],A=c(q,p),d=M.get(A),d===void 0){var O=i.get(A);if(O!==void 0){i.delete(A),M.set(A,O);var X=_?_.next:u;K(e,_,O),K(e,O,X),ye(O,X,o),_=O}else{var l=u?u.e.nodes_start:o;_=ke(l,e,_,_===null?e.first:_.next,q,A,p,t,s,m)}M.set(A,_),S=[],D=[],u=_.next;continue}if(g&&qe(d,q,p,s),(d.e.f&me)!==0&&(Re(d.e),w&&(d.a?.unfix(),(y??=new Set).delete(d))),d!==u){if(h!==void 0&&h.has(d)){if(S.length<D.length){var f=D[0],v;_=f.prev;var b=S[0],P=S[S.length-1];for(v=0;v<S.length;v+=1)ye(S[v],f,o);for(v=0;v<D.length;v+=1)h.delete(D[v]);K(e,b.prev,P.next),K(e,_,b),K(e,P,f),u=f,_=P,p-=1,S=[],D=[]}else h.delete(d),ye(d,u,o),K(e,d.prev,d.next),K(e,d,_===null?e.first:_.next),K(e,_,d),_=d;continue}for(S=[],D=[];u!==null&&u.k!==A;)(u.e.f&me)===0&&(h??=new Set).add(u),D.push(u),u=u.next;if(u===null)continue;d=u}S.push(d),_=d,u=d.next}if(u!==null||h!==void 0){for(var k=h===void 0?[]:De(h);u!==null;)(u.e.f&me)===0&&k.push(u),u=u.next;var F=k.length;if(F>0){var Y=(s&$e)!==0&&T===0?o:null;if(w){for(p=0;p<F;p+=1)k[p].a?.measure();for(p=0;p<F;p+=1)k[p].a?.fix()}Ea(e,k,Y)}}w&&la(()=>{if(y!==void 0)for(d of y)d.a?.apply()}),r.first=e.first&&e.first.e,r.last=_&&_.e;for(var L of i.values())He(L.e);i.clear()}function qe(r,n,e,i){(i&fe)!==0&&Me(r.v,n),(i&de)!==0?Me(r.i,e):r.i=e}function ke(r,n,e,i,o,t,s,c,m,w,g){var T=(m&fe)!==0,M=(m&ra)===0,$=T?M?H(o,!1,!1):Ie(o):o,u=(m&de)===0?s:Ie(s),h={i:u,v:$,k:t,a:null,e:null,prev:e,next:i};try{if(r===null){var _=document.createDocumentFragment();_.append(r=Ne())}return h.e=be(()=>c(r,$,u,w),W),h.e.prev=e&&e.e,h.e.next=i&&i.e,e===null?g||(n.first=h):(e.next=h,e.e.next=h.e),i!==null&&(i.prev=h,i.e.prev=h.e),h}finally{}}function ye(r,n,e){for(var i=r.next?r.next.e.nodes_start:e,o=n?n.e.nodes_start:e,t=r.e.nodes_start;t!==null&&t!==i;){var s=ta(t);o.before(t),t=s}}function K(r,n,e){n===null?r.first=e:(n.next=e,n.e.next=e&&e.e),e!==null&&(e.prev=n,e.e.prev=n&&n.e)}const Pe=[...` 	
\r\fÂ \v\uFEFF`];function Ta(r,n,e){var i=""+r;if(e){for(var o in e)if(e[o])i=i?i+" "+o:o;else if(i.length)for(var t=o.length,s=0;(s=i.indexOf(o,s))>=0;){var c=s+t;(s===0||Pe.includes(i[s-1]))&&(c===i.length||Pe.includes(i[c]))?i=(s===0?"":i.substring(0,s))+i.substring(c+1):s=c}}return i===""?null:i}function Oa(r,n,e,i,o,t){var s=r.__className;if(W||s!==e||s===void 0){var c=Ta(e,i,t);(!W||c!==r.getAttribute("class"))&&(c==null?r.removeAttribute("class"):r.className=c),r.__className=e}else if(t&&o!==t)for(var m in t){var w=!!t[m];(o==null||w!==!!o[m])&&r.classList.toggle(m,w)}return t}function Fe(r,n,e=!1){if(r.multiple){if(n==null)return;if(!Le(n))return va();for(var i of r.options)i.selected=n.includes(ne(i));return}for(i of r.options){var o=ne(i);if(ca(o,n)){i.selected=!0;return}}(!e||n!==void 0)&&(r.selectedIndex=-1)}function Sa(r){var n=new MutationObserver(()=>{Fe(r,r.__value)});n.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),pa(()=>{n.disconnect()})}function Ia(r,n,e=n){var i=!0;fa(r,"change",o=>{var t=o?"[selected]":":checked",s;if(r.multiple)s=[].map.call(r.querySelectorAll(t),ne);else{var c=r.querySelector(t)??r.querySelector("option:not([disabled])");s=c&&ne(c)}e(s)}),ua(()=>{var o=n();if(Fe(r,o,i),i&&o===void 0){var t=r.querySelector(":checked");t!==null&&(o=ne(t),e(o))}r.__value=o,i=!1}),Sa(r)}function ne(r){return"__value"in r?r.__value:r.value}var Ma=U('<div class="participant-item"><div class="participant-info"><div class="participant-name"> </div></div></div>'),xa=U('<div class="theme-group"><h3> </h3> <!></div>'),Ca=U("<p>No order generated yet.</p>"),Pa=U('<div class="results"><h2>Presentation Order</h2> <!> <!> <div class="results-actions"><button class="clear-button">Clear All Data</button></div></div>'),Na=U("<option> </option>"),Da=U("<p>Generating...</p>"),La=U('<div class="input-section"><h2>Enter information</h2> <p>All 15 participants must fill out their information before generating the order</p> <div class="participant-list"><div class="select-container"><select class="name-input"></select></div> <div class="keywords-container"><textarea class="keywords-input" placeholder="Keywords (comma separated)" rows="6"></textarea></div></div> <button>Save</button> <div class="action-section"><button><!></button></div></div>'),Ra=U('<div class="container"></div> <h1>Presentation randomizer</h1> <!>',1);function ja(r,n){_a(n,!1);const e=H(),i=H(),o=H();let t=H([{name:"Arnar",id:0,keywords:""},{name:"Cassandra",id:1,keywords:""},{name:"Costanza",id:2,keywords:""},{name:"Diana",id:3,keywords:""},{name:"Haotong",id:4,keywords:""},{name:"Kosara",id:5,keywords:""},{name:"Li",id:6,keywords:""},{name:"Luca M",id:7,keywords:""},{name:"Luca W",id:8,keywords:""},{name:"Lucas G",id:9,keywords:""},{name:"Martina",id:10,keywords:""},{name:"Matteo",id:11,keywords:""},{name:"Samuel",id:12,keywords:""},{name:"Sergio",id:13,keywords:""},{name:"Zhiyi",id:14,keywords:""}]),s=H(!1),c=H(!1),m=H([]),w=[],g=H(!1),T=H(0),M=H(!0),$=!1;const u="https://randominfo.vercel.app";let h=H();Ke(async()=>{await _(),E(M,!1)});async function _(){try{const l=await fetch(`${u}/api/data`);if(l.ok){const f=await l.json();E(t,f.participants||a(t)),E(T,f.selectedParticipantId??0),E(g,f.isRandomized||!1),E(m,f.presentationOrder||[]),w=f.groups||[]}}catch(l){console.error("Error loading data:",l)}}async function y(){if(!$){$=!0;try{(await fetch(`${u}/api/data`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({participants:a(t),selectedParticipantId:a(T),isRandomized:a(g),presentationOrder:a(m),groups:w})})).ok||console.error("Failed to save data")}catch(l){console.error("Error saving data:",l)}finally{$=!1}}}function S(l){const f=a(t).map(v=>v.id===a(e).id?{...v,keywords:l.target.value}:v);E(t,f)}async function D(){try{(await fetch(`${u}/api/data`,{method:"DELETE"})).ok?(E(t,a(t).map(f=>({...f,keywords:""}))),E(g,!1),E(m,[]),w=[],E(T,0)):console.error("Failed to clear data")}catch(l){console.error("Error clearing data:",l)}}async function q(){if(!(!a(c)||a(g))){E(s,!0);try{console.log(`Calling API at ${u}`);const l=a(t).filter(k=>k.keywords.trim()!=="").map(k=>({name:k.name,keywords:k.keywords.trim()})),f=await fetch(`${u}/api/group-topics`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({participants:l})});if(!f.ok){const k=await f.json().catch(()=>({}));throw new Error(k.message||`HTTP ${f.status}: ${f.statusText}`)}const v=await f.json();if(!v.groups||!Array.isArray(v.groups))throw new Error("Invalid response format from server");console.log("Received data:",v);const b=A([...v.groups]),P=[];b.forEach(k=>{A([...k.members]).forEach(Y=>{P.push({...Y,theme:k.theme})})}),E(m,P),w=b,E(g,!0),await y()}catch(l){console.error("Error generating order:",l),`${l.message}`,l.message.includes("fetch")||l.message.includes("quota")||l.message.includes("API key")}finally{E(s,!1)}}}function A(l){const f=[...l];for(let v=f.length-1;v>0;v--){const b=Math.floor(Math.random()*(v+1));[f[v],f[b]]=[f[b],f[v]]}return f}te(()=>a(t),()=>{E(c,a(t).every(l=>l.keywords.trim()!==""))}),te(()=>(a(M),a(h)),()=>{a(M)||(clearTimeout(a(h)),E(h,setTimeout(()=>{y()},1e3)))}),te(()=>(a(t),a(T)),()=>{E(e,a(t).find(l=>l.id===a(T))||a(t)[0])}),te(()=>a(t),()=>{E(i,a(t).filter(l=>l.keywords.trim()!=="").length)}),te(()=>a(m),()=>{E(o,a(m).reduce((l,f,v)=>{const b=f.theme;return l[b]||(l[b]=[]),l[b].push({...f,position:v+1}),l},{}))}),ma(),je();var d=Ra(),p=V(he(d),4);{var O=l=>{var f=Pa(),v=V(C(f),2);{var b=L=>{var G=xe(),se=he(G);we(se,1,()=>(a(o),j(()=>Object.entries(a(o)))),ge,(ue,ve,Ee,N)=>{var x=ya(()=>ba(a(ve),2));let J=()=>a(x)[0],ae=()=>a(x)[1];var B=xa(),z=C(B),Z=C(z,!0);I(z);var Q=V(z,2);we(Q,1,ae,ge,(Ge,Ae)=>{var ce=Ma(),Te=C(ce),Oe=C(Te),ze=C(Oe,!0);I(Oe),I(Te),I(ce),ee(()=>le(ze,(a(Ae),j(()=>a(Ae).name)))),R(Ge,ce)}),I(B),ee(()=>le(Z,J())),R(ue,B)}),R(L,G)};ie(v,L=>{a(o),j(()=>Object.keys(a(o)).length>0)&&L(b)})}var P=V(v,2);{var k=L=>{var G=Ca();R(L,G)};ie(P,L=>{a(m),j(()=>a(m).length===0)&&L(k)})}var F=V(P,2),Y=C(F);I(F),I(f),oe("click",Y,D),R(l,f)},X=l=>{var f=La(),v=V(C(f),4),b=C(v),P=C(b);ee(()=>{a(T),ga(()=>{a(t)})}),we(P,5,()=>a(t),ge,(N,x)=>{var J=Na(),ae=C(J,!0);I(J);var B={};ee(()=>{le(ae,(a(x),j(()=>a(x).name))),B!==(B=(a(x),j(()=>a(x).id)))&&(J.value=(J.__value=(a(x),j(()=>a(x).id)))??"")}),R(N,J)}),I(P),I(b);var k=V(b,2),F=C(k);wa(F),I(k),I(v);var Y=V(v,2),L=V(Y,2),G=C(L);let se;var ue=C(G);{var ve=N=>{var x=Da();R(N,x)},Ee=N=>{var x=xe(),J=he(x);{var ae=z=>{var Z=Ce();ee(Q=>le(Z,`Waiting for all participants (${Q??""}/15)`),[()=>(a(t),j(()=>a(t).filter(Q=>Q.name.trim()&&Q.keywords.trim()).length))]),R(z,Z)},B=z=>{var Z=Ce("Generate Presentation Order");R(z,Z)};ie(J,z=>{a(c)?z(B,!1):z(ae)},!0)}R(N,x)};ie(ue,N=>{a(s)?N(ve):N(Ee,!1)})}I(G),I(L),I(f),ee(N=>{ka(F,(a(e),j(()=>a(e).keywords))),se=Oa(G,1,"generate-button",null,se,N),G.disabled=!a(c)||a(s)},[()=>({disabled:!a(c)||a(s)})]),Ia(P,()=>a(T),N=>E(T,N)),oe("input",F,S),oe("click",Y,()=>{y()}),oe("click",G,q),R(l,f)};ie(p,l=>{a(g),a(m),j(()=>a(g)&&a(m).length>0)?l(O):l(X,!1)})}R(r,d),ha()}export{ja as component};
