import"../chunks/DsnmJJEf.js";import{i as va}from"../chunks/CxuTVblW.js";import{o as fa,e as fe,s as Z}from"../chunks/CZWMsW5p.js";import{c as Te,h as B,T as ua,e as Je,a as ca,b as _a,I as r,V as pa,r as ma,H as ha,s as Ge,d as Ie,k as ue,W as ga,X as wa,f as Ne,i as ya,g as ba,Y as Ue,Z as Xe,_ as F,$ as Fe,a0 as ze,j as Ze,p as ka,a1 as ye,a2 as Ce,a3 as Qe,a4 as be,a5 as Ea,a6 as Aa,a7 as xa,a8 as Oa,a9 as Sa,aa as Ta,ab as ea,q as Re,ac as Ia,ad as aa,ae as Ca,af as Pa,ag as ra,ah as ta,ai as Da,O as Ma,aj as me,ak as Na,x as X,S as D,u as he,w as L,P as Ra,al as b,D as q,Q as k,am as Ve,R as w,y as te,an as La,ao as qa,o as Pe,ap as Ha,aq as $a,ar as je}from"../chunks/B089eHam.js";import{i as ce}from"../chunks/RsWywM0O.js";import{r as Ke,a as Ga}from"../chunks/C1nE1ELk.js";function ge(t,s){return s}function Fa(t,s,e){for(var i=t.items,l=[],d=s.length,a=0;a<d;a++)xa(s[a].e,l,!0);var c=d>0&&l.length===0&&e!==null;if(c){var E=e.parentNode;Oa(E),E.append(e),i.clear(),Y(t,s[0].prev,s[d-1].next)}Sa(l,()=>{for(var o=0;o<d;o++){var g=s[o];c||(i.delete(g.k),Y(t,g.prev,g.next)),Qe(g.e,!c)}})}function we(t,s,e,i,l,d=null){var a=t,c={flags:s,items:new Map,first:null},E=(s&ea)!==0;if(E){var o=t;a=B?Te(ua(o)):o.appendChild(Je())}B&&ca();var g=null,M=!1,S=new Map,C=pa(()=>{var O=e();return Xe(O)?O:O==null?[]:Ue(O)}),u,m;function _(){za(m,u,c,S,a,l,s,i,e),d!==null&&(u.length===0?g?Ze(g):g=Ne(()=>d(a)):g!==null&&ka(g,()=>{g=null}))}_a(()=>{m??=Ta,u=r(C);var O=u.length;if(M&&O===0)return;M=O===0;let I=!1;if(B){var H=ma(a)===ha;H!==(O===0)&&(a=Ge(),Te(a),Ie(!1),I=!0)}if(B){for(var $=null,A,v=0;v<O;v++){if(ue.nodeType===ga&&ue.data===wa){a=ue,I=!0,Ie(!1);break}var p=u[v],T=i(p,v);A=Le(ue,c,$,null,p,T,v,l,s,e),c.items.set(T,A),$=A}O>0&&Te(Ge())}if(B)O===0&&d&&(g=Ne(()=>d(a)));else if(ya()){var Q=new Set,ie=ba;for(v=0;v<O;v+=1){p=u[v],T=i(p,v);var J=c.items.get(T)??S.get(T);J?(s&(be|ye))!==0&&ia(J,p,v,s):(A=Le(null,c,null,null,p,T,v,l,s,e,!0),S.set(T,A)),Q.add(T)}for(const[n,f]of c.items)Q.has(n)||ie.skipped_effects.add(f.e);ie.add_callback(_)}else _();I&&Ie(!0),r(C)}),B&&(a=ue)}function za(t,s,e,i,l,d,a,c,E){var o=(a&Ia)!==0,g=(a&(be|ye))!==0,M=s.length,S=e.items,C=e.first,u=C,m,_=null,O,I=[],H=[],$,A,v,p;if(o)for(p=0;p<M;p+=1)$=s[p],A=c($,p),v=S.get(A),v!==void 0&&(v.a?.measure(),(O??=new Set).add(v));for(p=0;p<M;p+=1){if($=s[p],A=c($,p),v=S.get(A),v===void 0){var T=i.get(A);if(T!==void 0){i.delete(A),S.set(A,T);var Q=_?_.next:u;Y(e,_,T),Y(e,T,Q),De(T,Q,l),_=T}else{var ie=u?u.e.nodes_start:l;_=Le(ie,e,_,_===null?e.first:_.next,$,A,p,d,a,E)}S.set(A,_),I=[],H=[],u=_.next;continue}if(g&&ia(v,$,p,a),(v.e.f&Ce)!==0&&(Ze(v.e),o&&(v.a?.unfix(),(O??=new Set).delete(v))),v!==u){if(m!==void 0&&m.has(v)){if(I.length<H.length){var J=H[0],n;_=J.prev;var f=I[0],h=I[I.length-1];for(n=0;n<I.length;n+=1)De(I[n],J,l);for(n=0;n<H.length;n+=1)m.delete(H[n]);Y(e,f.prev,h.next),Y(e,_,f),Y(e,h,J),u=J,_=h,p-=1,I=[],H=[]}else m.delete(v),De(v,u,l),Y(e,v.prev,v.next),Y(e,v,_===null?e.first:_.next),Y(e,_,v),_=v;continue}for(I=[],H=[];u!==null&&u.k!==A;)(u.e.f&Ce)===0&&(m??=new Set).add(u),H.push(u),u=u.next;if(u===null)continue;v=u}I.push(v),_=v,u=v.next}if(u!==null||m!==void 0){for(var y=m===void 0?[]:Ue(m);u!==null;)(u.e.f&Ce)===0&&y.push(u),u=u.next;var N=y.length;if(N>0){var G=(a&ea)!==0&&M===0?l:null;if(o){for(p=0;p<N;p+=1)y[p].a?.measure();for(p=0;p<N;p+=1)y[p].a?.fix()}Fa(e,y,G)}}o&&Re(()=>{if(O!==void 0)for(v of O)v.a?.apply()}),t.first=e.first&&e.first.e,t.last=_&&_.e;for(var z of i.values())Qe(z.e);i.clear()}function ia(t,s,e,i){(i&be)!==0&&ze(t.v,s),(i&ye)!==0?ze(t.i,e):t.i=e}function Le(t,s,e,i,l,d,a,c,E,o,g){var M=(E&be)!==0,S=(E&Ea)===0,C=M?S?F(l,!1,!1):Fe(l):l,u=(E&ye)===0?a:Fe(a),m={i:u,v:C,k:d,a:null,e:null,prev:e,next:i};try{if(t===null){var _=document.createDocumentFragment();_.append(t=Je())}return m.e=Ne(()=>c(t,C,u,o),B),m.e.prev=e&&e.e,m.e.next=i&&i.e,e===null?g||(s.first=m):(e.next=m,e.e.next=m.e),i!==null&&(i.prev=m,i.e.prev=m.e),m}finally{}}function De(t,s,e){for(var i=t.next?t.next.e.nodes_start:e,l=s?s.e.nodes_start:e,d=t.e.nodes_start;d!==null&&d!==i;){var a=Aa(d);l.before(d),d=a}}function Y(t,s,e){s===null?t.first=e:(s.next=e,s.e.next=e&&e.e),e!==null&&(e.prev=s,e.e.prev=s&&s.e)}const We=[...` 	
\r\fÂ \v\uFEFF`];function Va(t,s,e){var i=""+t;if(e){for(var l in e)if(e[l])i=i?i+" "+l:l;else if(i.length)for(var d=l.length,a=0;(a=i.indexOf(l,a))>=0;){var c=a+d;(a===0||We.includes(i[a-1]))&&(c===i.length||We.includes(i[c]))?i=(a===0?"":i.substring(0,a))+i.substring(c+1):a=c}}return i===""?null:i}function ja(t,s,e,i,l,d){var a=t.__className;if(B||a!==e||a===void 0){var c=Va(e,i,d);(!B||c!==t.getAttribute("class"))&&(c==null?t.removeAttribute("class"):t.className=c),t.__className=e}else if(d&&l!==d)for(var E in d){var o=!!d[E];(l==null||o!==!!l[E])&&t.classList.toggle(E,o)}return d}function na(t,s,e=!1){if(t.multiple){if(s==null)return;if(!Xe(s))return Pa();for(var i of t.options)i.selected=s.includes(_e(i));return}for(i of t.options){var l=_e(i);if(ra(l,s)){i.selected=!0;return}}(!e||s!==void 0)&&(t.selectedIndex=-1)}function Ka(t){var s=new MutationObserver(()=>{na(t,t.__value)});s.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ta(()=>{s.disconnect()})}function Wa(t,s,e=s){var i=!0;aa(t,"change",l=>{var d=l?"[selected]":":checked",a;if(t.multiple)a=[].map.call(t.querySelectorAll(d),_e);else{var c=t.querySelector(d)??t.querySelector("option:not([disabled])");a=c&&_e(c)}e(a)}),Ca(()=>{var l=s();if(na(t,l,i),i&&l===void 0){var d=t.querySelector(":checked");d!==null&&(l=_e(d),e(l))}t.__value=l,i=!1}),Ka(t)}function _e(t){return"__value"in t?t.__value:t.value}const Me=new Set;function Ye(t,s,e,i,l=i){var d=e.getAttribute("type")==="checkbox",a=t;let c=!1;if(s!==null)for(var E of s)a=a[E]??=[];a.push(e),aa(e,"change",()=>{var o=e.__value;d&&(o=Be(a,o,e.checked)),l(o)},()=>l(d?[]:null)),Da(()=>{var o=i();if(B&&e.defaultChecked!==e.checked){c=!0;return}d?(o=o||[],e.checked=o.includes(e.__value)):e.checked=ra(e.__value,o)}),ta(()=>{var o=a.indexOf(e);o!==-1&&a.splice(o,1)}),Me.has(a)||(Me.add(a),Re(()=>{a.sort((o,g)=>o.compareDocumentPosition(g)===4?-1:1),Me.delete(a)})),Re(()=>{if(c){var o;if(d)o=Be(a,o,e.checked);else{var g=a.find(M=>M.checked);o=g?.__value}l(o)}})}function Be(t,s,e){for(var i=new Set,l=0;l<t.length;l+=1)t[l].checked&&i.add(t[l].__value);return e||i.delete(s),Array.from(i)}var Ya=X('<div class="participant-item"><div class="position"> </div> <div class="participant-info"><div class="participant-name"> </div> <div class="participant-keywords"> </div></div></div>'),Ba=X('<div class="theme-group"><h3 class="theme-title"> </h3> <div class="theme-participants"></div></div>'),Ja=X('<div class="participant-item"><div class="position"></div> <div class="participant-info"><div class="participant-name"> </div> <div class="participant-keywords"> </div></div></div>'),Ua=X("<p>No order generated yet.</p>"),Xa=X('<div class="results"><h2>Presentation Order</h2> <div class="view-toggle"><label><input type="radio"/> Grouped by themes</label> <label><input type="radio"/> Simple shuffle</label></div> <!> <!> <div class="results-actions"><button class="clear-button">Clear All Data</button></div></div>'),Za=X("<option> </option>"),Qa=X("<p>Generating...</p>"),er=X('<div class="input-section"><h2>Enter information</h2> <p>All 15 participants must fill out their information before generating the order</p> <div class="participant-list"><div class="select-container"><select class="name-input"></select></div> <div class="keywords-container"><textarea class="keywords-input" placeholder="Keywords (comma separated)" rows="6"></textarea></div></div> <button>Save</button> <div class="action-section"><button><!></button></div> <button class="clear-button">Clear All Data</button></div>'),ar=X('<div class="container"></div> <h1>Presentation randomizer</h1> <!>',1);function or(t,s){Ma(s,!1);const e=F(),i=F(),l=F(),d=[];let a=F([{name:"Arnar",id:0,keywords:""},{name:"Cassandra",id:1,keywords:""},{name:"Costanza",id:2,keywords:""},{name:"Diana",id:3,keywords:""},{name:"Haotong",id:4,keywords:""},{name:"Kosara",id:5,keywords:""},{name:"Li",id:6,keywords:""},{name:"Luca M",id:7,keywords:""},{name:"Luca W",id:8,keywords:""},{name:"Lucas G",id:9,keywords:""},{name:"Martina",id:10,keywords:""},{name:"Matteo",id:11,keywords:""},{name:"Samuel",id:12,keywords:""},{name:"Sergio",id:13,keywords:""},{name:"Zhiyi",id:14,keywords:""}]),c=F(!1),E=F(!1),o=F([]),g=F([]),M=[],S=F(!1),C=F(0),u=!1,m=F(!0);const _="https://randominfo.vercel.app";fa(async()=>{await O()});async function O(){try{const n=await fetch(`${_}/api/data`);if(n.ok){const f=await n.json();b(a,f.participants||r(a)),b(C,f.selectedParticipantId??0),b(S,f.isRandomized||!1),b(o,f.presentationOrder||[]),b(g,f.simpleOrder||[]),M=f.groups||[]}}catch(n){console.error("Error loading data:",n)}}async function I(){if(!u){u=!0;try{(await fetch(`${_}/api/data`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({participants:r(a),selectedParticipantId:r(C),isRandomized:r(S),presentationOrder:r(o),simpleOrder:r(g),groups:M})})).ok||console.error("Failed to save data")}catch(n){console.error("Error saving data:",n)}finally{u=!1}}}function H(n){const f=r(a).map(h=>h.id===r(e).id?{...h,keywords:n.target.value}:h);b(a,f)}async function $(){try{(await fetch(`${_}/api/data`,{method:"DELETE"})).ok?(b(a,r(a).map(f=>({...f,keywords:""}))),b(S,!1),b(o,[]),b(g,[]),M=[],b(C,0)):console.error("Failed to clear data")}catch(n){console.error("Error clearing data:",n)}}function A(n){const f=[...n];for(let h=f.length-1;h>0;h--){const y=Math.floor(Math.random()*(h+1));[f[h],f[y]]=[f[y],f[h]]}return f}function v(){return r(a).filter(n=>n.keywords.trim()!=="").map(n=>({name:n.name,keywords:n.keywords.trim()}))}async function p(){if(!(!r(E)||r(S))){b(c,!0);try{console.log(`Calling API at ${_}`);const n=v(),f=await fetch(`${_}/api/group-topics`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({participants:n})});if(!f.ok){const G=await f.json().catch(()=>({}));throw new Error(G.message||`HTTP ${f.status}: ${f.statusText}`)}const h=await f.json();if(!h.groups||!Array.isArray(h.groups))throw new Error("Invalid response format from server");console.log("Received data:",h);const y=A([...h.groups]),N=[];y.forEach(G=>{A([...G.members]).forEach(ee=>{N.push({...ee,theme:G.theme})})}),b(o,N),M=y,b(g,A([...v()])),b(S,!0),await I()}catch(n){console.error("Error generating order:",n),`${n.message}`,n.message.includes("fetch")||n.message.includes("quota")||n.message.includes("API key")}finally{b(c,!1)}}}me(()=>r(a),()=>{b(E,r(a).every(n=>n.keywords.trim()!==""))}),me(()=>(r(a),r(C)),()=>{b(e,r(a).find(n=>n.id===r(C))||r(a)[0])}),me(()=>r(a),()=>{b(i,r(a).filter(n=>n.keywords.trim()!=="").length)}),me(()=>r(o),()=>{b(l,r(o).reduce((n,f,h)=>{const y=f.theme;return n[y]||(n[y]=[]),n[y].push({...f,position:h+1}),n},{}))}),Na(),va();var T=ar(),Q=D(he(T),4);{var ie=n=>{var f=Xa(),h=D(k(f),2),y=k(h),N=k(y);Ke(N),N.value=N.__value=!0,Ve(),w(y);var G=D(y,2),z=k(G);Ke(z),z.value=z.__value=!1,Ve(),w(G),w(h);var ee=D(h,2);{var le=P=>{var x=Pe(),R=he(x);we(R,1,()=>(r(l),q(()=>Object.entries(r(l)))),ge,(V,K,re,j)=>{var W=Ha(()=>$a(r(K),2));let U=()=>r(W)[0],de=()=>r(W)[1];var ve=Ba(),ne=k(ve),Ae=k(ne,!0);w(ne);var qe=D(ne,2);we(qe,5,de,ge,(sa,se)=>{var xe=Ya(),Oe=k(xe),la=k(Oe);w(Oe);var He=D(Oe,2),Se=k(He),oa=k(Se,!0);w(Se);var $e=D(Se,2),da=k($e,!0);w($e),w(He),w(xe),te(()=>{Z(la,`#${r(se),q(()=>r(se).position)??""}`),Z(oa,(r(se),q(()=>r(se).name))),Z(da,(r(se),q(()=>r(se).keywords)))}),L(sa,xe)}),w(qe),w(ve),te(()=>Z(Ae,U())),L(V,ve)}),L(P,x)},ae=P=>{var x=Pe(),R=he(x);we(R,1,()=>r(g),ge,(V,K,re)=>{var j=Ja(),W=k(j);W.textContent=`#${re+1}`;var U=D(W,2),de=k(U),ve=k(de,!0);w(de);var ne=D(de,2),Ae=k(ne,!0);w(ne),w(U),w(j),te(()=>{Z(ve,(r(K),q(()=>r(K).name))),Z(Ae,(r(K),q(()=>r(K).keywords)))}),L(V,j)}),L(P,x)};ce(ee,P=>{r(m),r(l),q(()=>r(m)&&Object.keys(r(l)).length>0)?P(le):P(ae,!1)})}var oe=D(ee,2);{var ke=P=>{var x=Ua();L(P,x)};ce(oe,P=>{r(o),q(()=>r(o).length===0)&&P(ke)})}var pe=D(oe,2),Ee=k(pe);w(pe),w(f),Ye(d,[],N,()=>r(m),P=>b(m,P)),Ye(d,[],z,()=>r(m),P=>b(m,P)),fe("click",Ee,$),L(n,f)},J=n=>{var f=er(),h=D(k(f),4),y=k(h),N=k(y);te(()=>{r(C),La(()=>{r(a)})}),we(N,5,()=>r(a),ge,(x,R)=>{var V=Za(),K=k(V,!0);w(V);var re={};te(()=>{Z(K,(r(R),q(()=>r(R).name))),re!==(re=(r(R),q(()=>r(R).id)))&&(V.value=(V.__value=(r(R),q(()=>r(R).id)))??"")}),L(x,V)}),w(N),w(y);var G=D(y,2),z=k(G);qa(z),w(G),w(h);var ee=D(h,2),le=D(ee,2),ae=k(le);let oe;var ke=k(ae);{var pe=x=>{var R=Qa();L(x,R)},Ee=x=>{var R=Pe(),V=he(R);{var K=j=>{var W=je();te(U=>Z(W,`Waiting for all participants (${U??""}/15)`),[()=>(r(a),q(()=>r(a).filter(U=>U.name.trim()&&U.keywords.trim()).length))]),L(j,W)},re=j=>{var W=je("Generate Presentation Order");L(j,W)};ce(V,j=>{r(E)?j(re,!1):j(K)},!0)}L(x,R)};ce(ke,x=>{r(c)?x(pe):x(Ee,!1)})}w(ae),w(le);var P=D(le,2);w(f),te(x=>{Ga(z,(r(e),q(()=>r(e).keywords))),oe=ja(ae,1,"generate-button",null,oe,x),ae.disabled=!r(E)||r(c)},[()=>({disabled:!r(E)||r(c)})]),Wa(N,()=>r(C),x=>b(C,x)),fe("input",z,H),fe("click",ee,()=>{I()}),fe("click",ae,p),fe("click",P,$),L(n,f)};ce(Q,n=>{r(S),r(o),q(()=>r(S)&&r(o).length>0)?n(ie):n(J,!1)})}L(t,T),Ra()}export{or as component};
